#%Module1.0#####################################################################
##
## artic modulefile
## By Alan Orth <a.orth@cgiar.org>
## February, 2023
##

set appname     artic
set version     1.2.3
set prefix      /export/apps/${appname}/${version}
set url         "https://github.com/artic-network/fieldbioinformatics"
set msg         "A bioinformatics pipeline for working with virus sequencing data sequenced with nanopore.\nOfficial site: $url\n"

# artic has these in its Python virtual environment so we should make sure not
# to load them from our modules.
conflict        medaka multiqc

module-whatis   $msg

prepend-path    PATH            ${prefix}/bin
prepend-path    PYTHONPATH      ${prefix}/lib/python3.8/site-packages

# artic/1.2.3 was installed with python/3.8
if { ![is-loaded python/3.8] } { 
    module load python/3.8
}

# artic/1.2.3 requires porechop/0.3.2pre
if { ![is-loaded porechop/0.3.2pre] } { 
    module load porechop/0.3.2pre
}

# artic/1.2.3 requires artic-tools/0.2.6
if { ![is-loaded artic-tools/0.2.6] } { 
    module load artic-tools/0.2.6
}

# artic/1.2.3 requires longshot/0.4.5
if { ![is-loaded longshot/0.4.5] } { 
    module load longshot/0.4.5 
}

# artic/1.2.3 requires longshot/0.4.5
if { ![is-loaded longshot/0.4.5] } { 
    module load longshot/0.4.5 
}

# artic/1.2.3 requires bcftools/1.15.1, which will also pull in htslib/1.15.1
if { ![is-loaded bcftools/1.15.1] } { 
    module load bcftools/1.15.1
}

# artic/1.2.3 requires bwa/0.7.17
if { ![is-loaded bwa/0.7.17] } { 
    module load bwa/0.7.17 
}

# artic/1.2.3 requires minimap2/2.24
if { ![is-loaded minimap2/2.24] } { 
    module load minimap2/2.24
}

# artic/1.2.3 requires muscle/3.8.1551
if { ![is-loaded muscle/3.8.1551] } { 
    module load muscle/3.8.1551
}

# artic/1.2.3 requires nanopolish/0.14.0
if { ![is-loaded nanopolish/0.14.0] } { 
    module load nanopolish/0.14.0
}

# artic/1.2.3 requires samtools/1.15.1
if { ![is-loaded samtools/1.15.1] } { 
    module load samtools/1.15.1
}

# vim: set sw=4 ts=4:
